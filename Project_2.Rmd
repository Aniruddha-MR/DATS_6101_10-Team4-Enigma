---
title: "Final_Yash"
output: html_document
date: "2023-10-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
setwd = "C:\\Users\\YASH KATTIMANI\\Downloads"
df = read.csv("C:\\Users\\YASH KATTIMANI\\Downloads\\newexercise_dataset.csv")
str(df)
```

```{r}
#converting exercise from char to factor
df$Exercise = as.factor(df$Exercise)
```

```{r}
df$Gender <- as.factor(df$Gender)
df$Weather.Conditions <- as.factor(df$Weather.Conditions)
```

## Deep Dataset Analysis

Frequency of different Exercises

```{r}
library(ggplot2)
exercise_count <- ggplot(df,aes(x= Exercise,fill = Exercise))+
  geom_bar()+
  labs(title ="Distribution of Exercise", x = "Exercise", y = "Count" )+
  theme(axis.text.x = element_text(angle = 75,hjust = 1))+
  scale_fill_manual(values = rainbow(length(unique(df$Exercise))))
print(exercise_count)
```

Classification of BMI values to 4 different categories

```{r}
# Creating a new variable BMI.Classification based on BMI values
df$BMI.Classification <- ifelse(df$BMI < 18.5, "Underweight",
                                ifelse(df$BMI < 25, "Healthy weight",
                                       ifelse(df$BMI < 30, "Overweight", "Obesity")))

head(df)
```

```{r}
bmi_bar_plot <- ggplot(df, aes(x = BMI.Classification, fill = BMI.Classification)) +
  geom_bar() +
  labs(title = "BMI Classification", x = "Classification", y = "Count") +
  scale_fill_manual(values = c(
    "Underweight" = "red",
    "Healthy weight" = "green",
    "Overweight" = "yellow",
    "Obesity" = "orange"
  )) +
  theme_minimal()

print(bmi_bar_plot)
```

Classification of Levels of Intensity based on Intensity values

```{r}
# Creating a new variable 'Intensity' based on Exercise.Intensity values
df$Intensity <- ifelse(df$Exercise.Intensity < 3, "Low Intensity",
                      ifelse(df$Exercise.Intensity < 6, "Medium Intensity", "High Intensity"))

# View the first few rows of the updated dataframe to verify the new variable
head(df)
```

Converting Heart rate to different levels "Low", "Moderate", "Elevated", "High", "Very High"

```{r}
breaks <- c(0, 100, 120, 140, 160, Inf)  # Customizing the breaks requirements
labels <- c("Low", "Moderate", "Elevated", "High", "Very High")

# Use the cut function to categorize Heart Rate into levels
df$HeartRateLevel <- cut(df$Heart.Rate, breaks = breaks, labels = labels, right = FALSE)
```

```{r}
df$BMI.Classification <- as.factor(df$BMI.Classification)
df$Intensity <- as.factor(df$Intensity)
df$Heart.Rate <- as.numeric(df$Heart.Rate)
```

## Analysis of age

ðŸ“ŒAge analysis shows that men are more active until the age of 28, then women dominate. In addition, there are a large number of people over the age of 60.

```{r}
# Create a density plot with KDE
density_plot <- ggplot(df, aes(x = Age, fill = Gender, color = Gender)) +
  geom_density(alpha = 0.5) +
  labs(title = "Age distribution", x = "Age") +
  theme_minimal() +
  scale_fill_manual(values = c("blue", "red")) +
  scale_color_manual(values = c("blue", "red"))

print(density_plot)
```

```{r}
hist(df$Age, main = "Distribution of Age", xlab = "Age", ylab = "Count", col = "lightblue")
```

### Analysis of BMI

```{r}
bmi_bar_plot <- ggplot(df, aes(x = BMI.Classification, fill = BMI.Classification)) +
  geom_bar() +
  labs(title = "BMI Classification", x = "Classification", y = "Count") +
  scale_fill_manual(values = c(
    "Underweight" = "red",
    "Healthy weight" = "green",
    "Overweight" = "yellow",
    "Obesity" = "orange"
  )) +
  theme_minimal()

print(bmi_bar_plot)
```

```{r}
# Calculating the distribution of BMI classifications
bmi_class_counts <- table(df$BMI.Classification)

# Calculating the percentages
bmi_class_percentages <- prop.table(bmi_class_counts) * 100

# Create a pie chart
pie(bmi_class_counts, labels = paste(names(bmi_class_counts), "(", round(bmi_class_percentages, 1), "%)"), col = c("red", "green", "blue"))
title("Distribution by BMI Classification")
```

```{r}
countplot <- ggplot(df, aes(x = Exercise, fill = BMI.Classification)) +
  geom_bar(position = "dodge") +
  labs(title = "Exercise by BMI Classification", x = "Exercise", y = "Count") +
  scale_fill_manual(values = c("Underweight" = "yellow","Overweight" = "red", "Obesity" = "green", "Healthy weight" = "blue")) +
  theme(axis.text.x = element_text(angle = 75, hjust = 1))

print(countplot)

```

different visualization

```{r}
library(dplyr)
# Calculate the count and frequency of BMI classifications by Exercise, Gender
df_summary <- df %>%
  group_by(Exercise, Gender, BMI.Classification) %>%
  summarise(count = n()) %>%
  mutate(frequency = count * 100 / sum(count))

# Create a grouped bar plot
grouped_bar_plot <- ggplot(df_summary, aes(x = Gender, y = frequency, fill = BMI.Classification)) +
  geom_bar(position = "dodge", stat = "identity") +
  scale_fill_manual(values = c("Overweight" = "red", "Obesity" = "green", "Healthy weight" = "blue")) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  facet_wrap(~Exercise) +
  theme_light() +
  labs(title = "(%) of exercises by gender and BMI Classification", fill = "BMI Classification", x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
  theme(legend.position = "top")

# Display the grouped bar plot
print(grouped_bar_plot)
```

## Calories burn and Intensity analysis

```{r}
exercise_calories <- ggplot(df, aes(x = Intensity, y = Calories.Burn)) +
  geom_histogram(stat = 'identity', fill = 'blue', color = 'grey') +
  labs(title = 'Exercise Intensity vs Calories Burn', x = 'Intensity', y = 'Calories Burn') +
  theme_minimal()

print(exercise_calories)
```

```{r}
library(ggplot2)

# Calculating efficiency
df <- transform(df, Efficiency = Calories.Burn / Duration)

# Sorting the data frame by efficiency in descending order
df <- df[order(-df$Efficiency), ]

# Defining a custom color palette
my_colors <- c("Aerobics" = "blue", "Strength Training" = "green", "High Intensity Training" = "yellow","Weight Training" = "orange", "Yoga" = "red", "Basic Workout" = "purple", "Cardio" = "pink","Leg Workout" = "brown", "Circuit Training" = "gray", "Core Workout" = "cyan")

# Creating a bar plot
efficiency_plot <- ggplot(df, aes(x = Efficiency, y = reorder(Exercise, -Efficiency))) +
  geom_bar(stat = "identity", aes(fill = Exercise)) +
  scale_fill_manual(values = my_colors) +
  labs(title = "Exercise Efficiency", x = "Efficiency", y = "Exercise") +
  theme_minimal()


print(efficiency_plot)
```

```{r}
# Calculate the count and frequency of exercises by Exercise, Gender, and Intensity
df_summary <- df %>%
  group_by(Exercise, Gender, Intensity) %>%
  summarise(count = n(), .groups = "drop") %>%
  mutate(frequency = count * 100 / sum(count))

# Create a grouped bar plot
grouped_bar_plot <- ggplot(df_summary, aes(x = Gender, y = frequency, fill = Intensity)) +
  geom_bar(position = "dodge", stat = "identity") +
  scale_fill_manual(values = c("red", "green", "blue", "purple", "orange", "pink", "yellow")) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  facet_wrap(~Exercise) +
  theme_light() +
  labs(title = "(%) of exercises by gender and intensity", fill = "Intensity", x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
  theme(legend.position = "top")

# Display the grouped bar plot
print(grouped_bar_plot)
```

### Analysis by weather 

```{r}
# Calculate the count and frequency of exercises by Exercise, Gender, and Weather Conditions
df_summary <- df %>%
  group_by(Exercise, Gender, Weather.Conditions) %>%
  summarise(count = n(), .groups = "drop") %>%
  mutate(frequency = count * 100 / sum(count))

# Create a grouped bar plot
grouped_bar_plot <- ggplot(df_summary, aes(x = Gender, y = frequency, fill = Weather.Conditions)) +
  geom_bar(position = "dodge", stat = "identity") +
  scale_fill_manual(values = c("red", "green", "blue", "purple", "orange", "pink", "yellow", "cyan", "magenta", "lime")) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  facet_wrap(~Exercise) +
  theme_light() +
  labs(title = "(%) of exercises by gender and weather", fill = "Weather", x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold")) +
  theme(legend.position = "top")

# Display the grouped bar plot
print(grouped_bar_plot)
```

```{r}

# Create a big grid of scatter plots with facets for Exercise and Weather Conditions
scatter_grid <- ggplot(df, aes(x = Duration, y = `Exercise.Intensity`)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +  # Add a line of best fit
  facet_grid(Exercise ~ `Weather.Conditions`) +
  labs(title = "Relationship between weather and exercise", x = "Duration", y = "Exercise Intensity") +
  theme_minimal()+
  theme(axis.text.y = element_blank())

# Display the big grid of plots
print(scatter_grid)

```

### Correlation Matrix

```{r}
str(df)
```
